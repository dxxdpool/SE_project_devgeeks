Final code as of 17/4/2023.
